# S3

A collection of matchers that you can use to assert on S3 bucket objects.

Use the `s3Object()` helper function to specify which S3 object you are testing. It takes the following input parameters:

- `nameName`: The bucket name where the object should be found.
- `key`: They key of the object you are looking for
- `retryPolicy`: An optional [node-retry](https://github.com/tim-kos/node-retry) options config. sls-jest will retry using the given retry policy until the test passes or all the retries are exhausted. This is useful in an asynchronous context.

## Matchers

### `toExist()`

Asserts whether an S3 object exists in the given bucket.

```ts
await expect(
  s3Object({
    bucketName: 'my-bucket',
    key: 'path/to/file.txt',
  }),
).toExist();
```

### `toExistAndMatchObject(value)`

Asserts that an object exists in the given bucket, and matches a subset of the properties of a javascript object. It works similarely to jest's [toMatchObject](https://jestjs.io/docs/expect#tomatchobjectobject).

Note: This matcher can only be used with S3 objects that contain JSON-like data. If the content of the file cannot be parsed to a valid JSON, an error will be thrown.

```ts
await expect(
  s3Object({
    bucketName: 'my-bucket',
    key: 'path/to/file.txt',
  }),
).toExistAndMatchObject({
  message: 'Hello world!',
});
```

### `toExistAndMatchSnapshot(propertiesOrHint?, hint?)`

Asserts that an item exists in the given bucket, and that it matches the most recent snapshot. It works similarely to jest's [toMatchSnapshot](https://jestjs.io/docs/expect#tomatchsnapshotpropertymatchers-hint).

Note: If the content of the file is a valid JSON, the content will be parsed and appear as an object in the snapshot.

```ts
await expect(
  s3Object({
    bucketName: 'my-bucket',
    key: 'path/to/file.txt',
  }),
).toExistAndMatchSnapshot();
```

### `toExistAndMatchInlineSnapshot(propertiesOrHint?, hint?)`

Asserts that an object exists in the given bucket, and that it matches the most recent inline snapshot. It works similarely to jest's [toMatchInlineSnapshot](https://jestjs.io/docs/expect#tomatchinlinesnapshotpropertymatchers-inlinesnapshot).

Note: If the content of the file is a valid JSON, the content will be parsed and appear as an object in the snapshot.

```ts
await expect(
  s3Object({
    bucketName: 'my-bucket',
    key: 'path/to/file.txt',
  }),
).toExistAndMatchInlineSnapshot(`
  Object {
    "message": 'Hello world!',
  }
`);
```
